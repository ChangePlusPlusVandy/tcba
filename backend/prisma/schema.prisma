// Prisma schema for TCBA coalition management platform
// Run npx prisma generate after changes to update types and regenerate client and model

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

// Organization permission levels for coalition platform
enum OrganizationRole {
  SUPER_ADMIN  // Full system access (TCBA staff)
  ADMIN        // Coalition management access
  MEMBER       // Standard nonprofit member
}

// Organization account states
enum OrganizationStatus {
  ACTIVE       // Can use platform
  INACTIVE     // Temporarily disabled
  PENDING      // Waiting for setup completion
  SUSPENDED    // Admin blocked access
}

// Tennessee regions for member organizations
enum TennesseeRegion {
  EAST
  MIDDLE
  WEST
}

// Organization size categories for dues calculation
enum OrganizationSize {
  SMALL
  MEDIUM
  LARGE
  EXTRA_LARGE
}

// The 45+ nonprofit organizations that are part of the Tennessee Coalition for Better Aging
// Can discuss splitting up this model into addresses table and org table for db normalization standards later
model Organization {
  id              String             @id @default(cuid())
  clerkId         String             @unique // Links to Clerk Auth
  name            String             @unique
  email           String             @unique // Organization email
  description     String?
  website         String?
  address         String?
  city            String?
  state           String?
  zipCode         String?
  primaryContactName        String
  primaryContactEmail       String
  primaryContactPhone       String
  secondaryContactName      String?
  secondaryContactEmail     String?
  region                    TennesseeRegion?       // East, Middle, or West Tennessee
  organizationType          String?                // Type of organization
  membershipActive          Boolean                @default(false)
  membershipDate            DateTime?              // Date when dues were paid/membership started
  membershipRenewalDate     DateTime?              // Date when membership needs to be renewed
  organizationSize          OrganizationSize?      // Size category for dues calculation

  role            OrganizationRole   @default(MEMBER)
  status          OrganizationStatus @default(PENDING)
  tags            String[]           // Focus area tags like ["Healthcare", "Senior Services", "Mental Health"]

  @@map("organizations")
}